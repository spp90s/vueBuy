<template>
    <div>
        <div class="section">
            <div class="location">
                <span>å½“å‰ä½ç½®ï¼š</span>
                <a href="/index.html">é¦–é¡µ</a> &gt;
                <a href="/goods.html">è´­ç‰©å•†åŸ</a> &gt;
                <a href="/goods/42/1.html">å•†å“è¯¦æƒ…</a>
            </div>
        </div>
        <div class="section">
            <div class="wrapper clearfix">
                <div class="wrap-box">
                    <div class="left-925">
                        <div class="goods-box clearfix">
                            <div class="pic-box"></div>
                            <div class="goods-spec">
                                <h1>{{goodsinfo.title}}</h1>
                                <p class="subtitle">{{goodsinfo.sub_title}}</p>
                                <div class="spec-box">
                                    <dl>
                                        <dt>è´§å·</dt>
                                        <dd id="commodityGoodsNo">{{goodsinfo.goods_no}}</dd>
                                    </dl>
                                    <dl>
                                        <dt>å¸‚åœºä»·</dt>
                                        <dd>
                                            <s id="commodityMarketPrice">{{goodsinfo.market_price}}</s>
                                        </dd>
                                    </dl>
                                    <dl>
                                        <dt>é”€å”®ä»·</dt>
                                        <dd>
                                            <em id="commoditySellPrice" class="price">{{goodsinfo.sell_price}}</em>
                                        </dd>
                                    </dl>
                                </div>
                                <div class="spec-box">
                                    <dl>
                                        <dt>è´­ä¹°æ•°é‡</dt>
                                        <dd>
                                            <div class="stock-box">
                                                <!-- element-uiçš„è®¡æ•°å™¨ç»„ä»¶ -->
                                                <el-input-number size="small" v-model="buyNum" @change="numChange" :min="1" :max="goodsinfo.stock_quantity" label="æè¿°æ–‡å­—"></el-input-number>
                                            </div>
                                            <span class="stock-txt">
                                                åº“å­˜
                                                <em id="commodityStockNum">{{goodsinfo.stock_quantity}}</em>ä»¶
                                            </span>
                                        </dd>
                                    </dl>
                                    <dl>
                                        <dd>
                                            <div id="buyButton" class="btn-buy">
                                                <button onclick="cartAdd(this,'/',1,'/shopping.html');" class="buy">ç«‹å³è´­ä¹°</button>
                                                <button onclick="cartAdd(this,'/',0,'/cart.html');" class="add">åŠ å…¥è´­ç‰©è½¦</button>
                                            </div>
                                        </dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                        <div id="goodsTabs" class="goods-tab bg-wrap">
                            <div id="tabHead" class="tab-head" style="position: static; top: 517px; width: 925px;">
                                <ul>
                                    <li>
                                        <a href="javascript:;" class="selected">å•†å“ä»‹ç»</a>
                                    </li>
                                    <li>
                                        <a href="javascript:;">å•†å“è¯„è®º</a>
                                    </li>
                                </ul>
                            </div>
                            <div class="tab-content entry" style="display: block;">
                                å†…å®¹
                            </div>
                            <div class="tab-content" style="display: block;">
                                <div class="comment-box">
                                    <div id="commentForm" name="commentForm" class="form-box">
                                        <div class="avatar-box">
                                            <i class="iconfont icon-user-full"></i>
                                        </div>
                                        <div class="conn-box">
                                            <div class="editor">
                                                <textarea id="txtContent" name="txtContent" sucmsg=" " datatype="*10-1000" nullmsg="è¯·å¡«å†™è¯„è®ºå†…å®¹ï¼"></textarea>
                                                <span class="Validform_checktip"></span>
                                            </div>
                                            <div class="subcon">
                                                <input id="btnSubmit" name="submit" type="submit" value="æäº¤è¯„è®º" class="submit">
                                                <span class="Validform_checktip"></span>
                                            </div>
                                        </div>
                                    </div>
                                    <ul id="commentList" class="list-box">
                                        <p style="margin: 5px 0px 15px 69px; line-height: 42px; text-align: center; border: 1px solid rgb(247, 247, 247);">æš‚æ— è¯„è®ºï¼Œå¿«æ¥æŠ¢æ²™å‘å§ï¼</p>
                                        <li>
                                            <div class="avatar-box">
                                                <i class="iconfont icon-user-full"></i>
                                            </div>
                                            <div class="inner-box">
                                                <div class="info">
                                                    <span>åŒ¿åç”¨æˆ·</span>
                                                    <span>2017/10/23 14:58:59</span>
                                                </div>
                                                <p>testtesttest</p>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="avatar-box">
                                                <i class="iconfont icon-user-full"></i>
                                            </div>
                                            <div class="inner-box">
                                                <div class="info">
                                                    <span>åŒ¿åç”¨æˆ·</span>
                                                    <span>2017/10/23 14:59:36</span>
                                                </div>
                                                <p>å¾ˆæ¸…æ™°è°ƒåŠ¨å•å¾ˆæ¸…æ™°è°ƒåŠ¨å•</p>
                                            </div>
                                        </li>
                                    </ul>
                                    <div class="page-box" style="margin: 5px 0px 0px 62px;">
                                        <div id="pagination" class="digg">
                                            <span class="disabled">Â« ä¸Šä¸€é¡µ</span>
                                            <span class="current">1</span>
                                            <span class="disabled">ä¸‹ä¸€é¡µ Â»</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="left-220">
                        <div class="bg-wrap nobg">
                            <div class="sidebar-box">
                                <h4>æ¨èå•†å“</h4>
                                <ul class="side-img-list">
                                    <li v-for="(item, index) in hotgoodslist" :key="item.id">
                                        <div class="img-box">
                                            <!-- <a href="#/site/goodsinfo/90" class=""> -->
                                            <router-link :to="'/detail/' + item.id">
                                                <img :src="item.img_url">
                                            </router-link>
                                            <!-- </a> -->
                                        </div>
                                        <div class="txt-box">
                                            <!-- <a href="#/site/goodsinfo/90" class=""> -->
                                            <router-link :to="'/detail/' + item.id">
                                                {{item.title}}
                                            </router-link>
                                            <!-- </a> -->
                                            <span>{{item.add_time | beautifyTime}}</span>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>
<script>

    // å¯¼å…¥axios
    // import axios from 'axios';   //è¿ç§»åˆ°main.jsä¸­

    // å¯¼å…¥moment.js
    // import moment from "moment"; //è¿ç§»åˆ°main.jsä¸­

    export default {
        // è¿™ä¸ªnameè·Ÿæ¨¡æ¿é‡Œçš„idæ— å…³ï¼Œè¿™ä¸ªnameå°†ä¼šæ˜¯åœ¨chromeçš„dev-toolsé‡Œçœ‹åˆ°çš„åå­—
        name: "detail",

        data: function() {
            return {
                // ä¼ è¿‡æ¥çš„å•†å“id
                goodsId: "",
                // å•†å“ä¿¡æ¯
                goodsinfo: {},
                // å›¾ç‰‡åˆ—è¡¨
                hotgoodslist: [],
                // å›¾ç‰‡åˆ—è¡¨
                imglist: [],
                // é€‰æ‹©æ•°é‡
                buyNum: 1
            }   
        },

        // åœ¨ä¸€ä¸ªç»„ä»¶çš„é€‰é¡¹ä¸­å®šä¹‰æœ¬åœ°çš„è¿‡æ»¤å™¨ï¼ˆå±€éƒ¨ï¼‰
        // filters: {
        //     beautifyTime: function(value) {
            
        //         // å¤„ç†ä¹‹å‰ï¼Œç¬¬ä¸€ä¸ªå‚æ•°valueå°±æ˜¯æ¥æ”¶è¦è¿‡æ»¤çš„å€¼ï¼Œå³æ¨¡æ¿åŒèŠ±æ‹¬å·æ’å€¼ä¸­ | å‰é¢å†™è¦è¿‡æ»¤çš„æ•°æ®
        //         // if (!value) return ''
        //         // value = value.toString()
        //         console.log(value);
        //         // è¿”å›å¤„ç†ä¹‹åçš„value
        //         // return value.charAt(0).toUpperCase() + value.slice(1)
        //         // return 'ğŸ–ğŸ–ğŸ–ğŸ–';
        //         // éœ€è¦ç”¨moment.jsæ¥æ ¼å¼åŒ–æ—¥æœŸï¼Œå†è¿”å›
        //         return moment(value).format("YYYYå¹´MMæœˆDDæ—¥");
        //     }
        // },

        // åˆ›å»ºVueå®ä¾‹å
        created() {
            // å½“åŒ¹é…åˆ°ä¸€ä¸ªè·¯ç”±æ—¶ï¼Œå‚æ•°å€¼ä¼šè¢«è®¾ç½®åˆ° this.$route.params è¿™ä¸ªå¯¹è±¡é‡Œï¼Œå¯ä»¥åœ¨æ¯ä¸ªç»„ä»¶å†…ä½¿ç”¨
            console.log(this.$route.params);
            console.log(this.$route.params.xxoo);

            this.goodsId = this.$route.params.xxoo;

            // axiosè°ƒç”¨æ¥å£è·å–æ•°æ®ï¼ˆæŠ½å–å‡ºæ¥ï¼‰
            // this.$axios.get(`site/goods/getgoodsinfo/${this.goodsId}`).then(response => {
            //     console.log(response);
            //     // å•†å“ä¿¡æ¯
            //     this.goodsinfo = response.data.message.goodsinfo;
            //     // å›¾ç‰‡åˆ—è¡¨
            //     this.hotgoodslist = response.data.message.hotgoodslist;
            //     // å›¾ç‰‡åˆ—è¡¨
            //     this.imglist = response.data.message.imglist;
                
            // })
            this.getGoodsInfo();
        },

        // äº‹ä»¶
        methods: {
            // è´­ä¹°æ•°é‡buyNumæ”¹å˜æ—¶è§¦å‘
            numChange() {
                console.log('numæ”¹å˜äº†');
                
            },

            // æ ¹æ®idè·å–ï¼Œå•†å“æ•°æ®çš„æ–¹æ³•
            getGoodsInfo() {
                // axiosè°ƒç”¨æ¥å£è·å–æ•°æ®
                this.$axios.get(`site/goods/getgoodsinfo/${this.goodsId}`).then(response => {
                    console.log(response);
                    // å•†å“ä¿¡æ¯
                    this.goodsinfo = response.data.message.goodsinfo;
                    // å›¾ç‰‡åˆ—è¡¨
                    this.hotgoodslist = response.data.message.hotgoodslist;
                    // å›¾ç‰‡åˆ—è¡¨
                    this.imglist = response.data.message.imglist;
                    
                })
            }
        },

        // è§‚å¯Ÿè·¯ç”±æ•°æ®æ”¹å˜ watchä¾¦å¬å¯¹åº”çš„æ•°æ®æ”¹å˜æ—¶è§¦å‘
        watch: {
            // ä¾¦å¬äº†$routeï¼Œä¸€æ—¦å‘é€æ”¹å˜ï¼Œä¼šæŠŠæ–°æ•°æ®è®¾ç½®ç»™toï¼Œè€æ•°æ®è®¾ç½®ç»™from
            '$route' (to, from) {
                // å¯¹è·¯ç”±å˜åŒ–ä½œå‡ºå“åº”...
                console.log(to);    //æ–°id
                console.log(from);  //æ—§id
                // è·å–æ–°idï¼Œå¹¶ä»¥æ­¤idå‘è¯·æ±‚è·å–æ•°æ®ï¼Œæ¸²æŸ“é¡µé¢
                this.goodsId = to.params.xxoo;
                // è°ƒç”¨ä¸€ä¸‹getGoodsInfoä»¥é‡æ–°è·å–æ•°æ®
                this.getGoodsInfo();
                // è·¯ç”±å‚æ•°æ”¹å˜æ—¶æŠŠè´­ä¹°æ•°é‡é‡ç½®ä¸º1
                this.buyNum = 1;
            }
        }
    }
</script>
<style>

</style>

 